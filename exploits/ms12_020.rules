# https://exploitshop.wordpress.com/2012/03/13/ms12-020-vulnerabilities-in-remote-desktop-could-allow-remote-code-execution/#comment-108
alert tcp any any -> any 3389 (flow:to_server,established; content:"|03 00|"; depth:2; content:"|7f 65 82|"; distance:5; within:3; content:"|30 19|"; distance:11; within:2; byte_test:1, any 3389 (flow:to_server,established; content:"|03 00|"; depth:2; content:"|7f 65 82|"; distance:5; within:3; content:"|30 1c|"; distance:65; within:2; byte_test:2,<,6,2,relative;)

# https://web.archive.org/web/20150423062353/http://blog.chackraview.net/2012/03/19/nids-signature-for-ms12-020-rdp-dos/
alert tcp any any -> $HOME_NET 3389 (msg:"Potential MS12-020 RDP DoS attempt - MaximumParatmers"; flow:to_server,established; content:"|03 00|"; depth:2; content:"|7f 65 82 01 94|"; distance:24; within:5; content:"|30 19|"; distance:9; within:2; content:"|30 19|"; distance:25; within:2;content:"|30 1c|"; distance:25; within:2; byte_test:1,=,255,2,relative;  reference:cve,2012-0002; classtype:attempted-dos; sid:1000031; rev:1;)
alert tcp any any -> $HOME_NET 3389 (msg:"Potential MS12-020 RDP DoS attempt - MaximumParatmers"; flow:to_server,established; content:"|03 00|"; offset:0; depth:2;content:"|7f 65 82 01 94|";distance:24;within:5;byte_jump:1,10,relative;byte_jump:1,1,relative;byte_test:1,=,255,4,relative; reference:cve,2012-0002; classtype:attempted-dos; sid:1000026;rev:1;priority:1;)
